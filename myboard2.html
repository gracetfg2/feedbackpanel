
<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="Grace Yen, Adobe System Corp.">
  
    <title>Prototype</title>
  

   <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
   <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
	<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"></script>
	<!-- JQuery and Google font -->
    <link href='https://fonts.googleapis.com/css?family=Exo:100,400' rel='stylesheet' type='text/css'>
	<!-- Custom styles for this template -->

<style>
        .droptarget {
            float: left; 
	        width: 300px; 
	        height: 3500px;
	        margin: 15px;
	        padding: 10px;
	        border: 1px solid #aaaaaa;
   		}
    	mark{
    		background: orange;
    		color: black;
		}
		.idea-unit:hover {
			cursor: pointer;
			background-color: lightgray;
		}

		.tableelement{
			cursor: pointer;

		}

		.visited { 
		    background-color: lightgrey;
		}

	
		.highlight{
			color: blue !important;;
		}

		.active-icon{
			color: red !important;
		}

.active-text{
	background-color: yellow;
}
.vis-content{
	text-align: justify; 
	padding-bottom:10px; 
	padding-right:25px;
}

p.success{
	color:green;
}
p.fail{
	color:red;
}

.original-feedback{
	margin: 10px;
	font-size: 20px;
}

</style>

</head>

<body>
<!--Consider set as element for django-->
<nav class="navbar navbar-fixed-top navbar-inverse" style="background:#002058">
        <div class="container">
            <div class="navbar-header">
               FeedbackPanel
            </div>  
        </div>
</nav>


<div id='page-1'>  
	<div class="container">
			<div class="main-section" style="margin-top: 50px">
		<div class="alert alert-info" role="alert" >
			<h4>Instruction</h4>
			 Please select values that make most sense to you blablabla. 
			<a type="button" class="btn btn-info" onclick='finishAnnoate();'>View My MindSpace</a>
		</div>
  		<nav aria-label="Page navigation example">
		  <ul class="pagination" id="page-list">
		    <li class="page-item" id="previous"><a class="page-link" href="#">Previous</a></li>
		    <li class="page-item" id="next"><a class="page-link" href="#">Next</a></li>
		  </ul>
		</nav>

		<div class="row" id='all_feedback_table'></div>

<template name='feedback_table'>
	<div class="annotate-panel" style='display:none;'>
	  <a class="btn btn-primary" data-toggle="collapse" href="" role="button" aria-expanded="false" >Read Origianl Feedback</a>

	<div class='collapse multi-collapse' name='original-feedback'></div>


	<table class='table table-hover table-nonfluid'>
		<thead>
		    <tr>
		      <th style="width:5%" scope="col">#</th>
		      <th style="width:35%" scope="col">Content</th>
		      <th style="width:10%" scope="col">Topic</th>
		      <th style="width:10%" scope="col">Sentiment</th>
		      <th style="width:10%" scope="col">Estimtated Effort</th>
		      <th style="width:10%" scope="col">Criticality</th>
		      <th style="width:10%" scope="col">Need Discussion</th>
		      <th style="width:10%" scope="col">Agree</th>
		    </tr>
		  </thead>
	
	<tbody id='ideaunits'>
		
	</tbody>
	</table>
	</div>

</template>

<template name='feedback-row-template'>
	<tr class='feedback-row'> 
		<th name='ideaid' scope='row'></th>
		<td name='content'></td>
		<td>
			<div class='topic-section1'>
			
			
				<span>Create a new label</span>
				<input type='text' style='display: inline-block;' name='new-topic'>
				<!--<button class='add-btn' name='add-btn'><span class='fa fa-plus' style=" font-size:24px;margin-right:3px"></span></button>-->
				<p name='check-result'></p>
				<br><br>
				Select from existing labels
			<select name='topic' style="margin-bottom: 5px">
				<option>Select from... </option>
			</select>
		</div>
		</td>
		<td><select name='sentiment'>
				<option></option>
				<option>strength</option>
				<option>weakness</option>
				<option>suggestion</option>
			</select>
		</td>
		<td><select name='effort'>
				<option></option>
				<option>high</option>
				<option>medium</option>
				<option>low</option>
				<option>N/A</option>
			</select>
		</td>
		<td><select name='criticality'>
				<option></option>
				<option>high</option>
				<option>medium</option>
				<option>low</option>
				<option>N/A</option>
			</select>
		</td>
		<td><select name='discussion'>
				<option></option>
				<option>yes</option>
				<option>no</option>
		</td> 
		<td><select name='agree'>
			<option></option>
			<option>completely</option>
			<option>partially</option>
			<option>no</option>
		</td> 
	</tr>
	
</template>
<div style='display: none'>
	<span class='table-text'>

   The paper contributes an experiment demonstrating the effectively of peer
   mentorship for design feedback, where  peers were assigned to give feedback on all
   stages of a project through an online platform.$ The paper contributes an
   understanding of how context and strategies for assigning feedback providers
   affect the perceived quality of feedback.$

   Evaluation of the paper's contribution depends on the experiment design as well as
   the quality of the arguments and findings for providing new empirical
   understanding of how and why such feedback assignment strategies may affect
   desired outcomes.$

The authors should respond to all issues raised by the reviewers. Here is a brief
   summary:$
   - a clearer description of the role of social bond theory in motivating the paper$
   - a clearer description of how certain dependent variables were chosen (and why
   they weren't discussed in the intro/related work)$
   - a clearer structure of the results section, with a clearer narrative linking to
   arguments$
   - using graphical visualizations of the most important findings $
   - discussion of how the proposed approach may extend to other contexts, both in
   the classroom and online$
   - responding to the 2AC's question on "How can one claim to measure “strong social
   bonds” between an “anonymous” feedback provider and a receiver/designer?"$

	</span>

<span class='table-text'>
	   The paper presents an experiment testing online peer mentorship in a multi-
   interaction project-based design course.$ The experiment is set out to challenge
   two assumptions common in peer review platforms: 1) that peer-assignment should be
   randomized, and that 2) design solutions should be assessed independently of prior
   solutions. $ The author(s) conducted surveys and interviews at the end of the course
   to evaluate the feedback of peer mentorship. $ The author(s) found that most
   students preferred to be mentors, rather than being assigned randomly for peer-
   feedback, as mentorship allowed them to follow closely the development progress of
   a design project, something which they found valuable and instructive.$
   Specifically, the author(s) found that students who were assigned to be mentors
   wrote longer, more positive and thorough feedback, than those who were assigned to
   provide random feedback to different projects.$ Furthermore, students who were
   assigned as peer mentors were more receptive to the feedback they received on
   their own projects.$ When it comes to showing the context of the project’s
   progression, this deemed to be more relevant at later stages of the project.$

   This is a very nicely written and clear paper, with a good flow and structure, and
   well-crafted arguments that seem to be grounded in the literature. $ It also
   contains thoughts for future work and a limitation section, thus giving the
   impression of solid research.$ It is based on both qualitative and quantitative
   data, which enrich and strengthen the findings.$

   Below I list a few minor unclear issues: $
   - Are you talking about undergraduate or graduate students? $ I believe there will
   be a difference in the attitude amongst these two different levels. $I would assume
   that such a project seems more suitable and beneficial to graduate students.$
   - It was not very clear to me whether the feedback from mentors was perceived as
   equally valuable as the ones received from those giving random feedback? $ One would
   expect that mentors who were given the possibility to focus on a single project
   and follow up its progression would be able to provide feedback which should be
   perceived as more useful and relevant. It would be interesting to know why is this
   not the case?$
   - Why was the perceived quality and social bond only measured from the point of
   view of those providing the feedback and not those receiving the feedback? $After
   all, one could claim that the later—meaning the view of those receiving the
   feedback—is more important (for the final project, the end results) than those
   giving the feedback.$
   - How can one claim to measure “strong social bonds” between an “anonymous”
   feedback provider and a receiver/designer? $One would except to remove anonymity if
   social bonds are to be established. It would be nice if this view was clarified.$

   Minor typos:
   - Missing reference in the text to figure 1 $
   - In the discussion section, second paragraph, replace the word “move” with “more”$
   - In the discussion section, paragraph 5, you spell out, what looks like, the
   names of your informants “Grace, Helen”$


</span>

<span class='table-text'> 
   In this paper authors discuss challenges of peer reviewing due to randomity. $They
   hypothesize that if the reviewers continue to be same for same project in design
   and provided the context of the previous submission feedback, the quality and
   social bond increases.$
   Review quality is measured by social bond and actions taken to the feedback,
   designers response, length of the feedback.$ Social bonds were measured via a
   questionnaire.$
   Study designed and 2x2x3 tests. With Randomize and Mentor, context shown x context
   not shown with a within subject factor which is the 3 project deliverable.$

      The paper provides 3 contributions for the CSCW community – how peer mentorship
   combined with context of the review artifact affect to the peer feedback, based on
   the outcome of the test guideline for instructor on which stages the context in
   more effective and finally these results provide a better ground to the platforms
   to design better peer reviewing strategies.$
   This research effort has a significant hypothesis and without a doubt it grounds
   the challenges very well using the previous literature.$ This really has a
   potential in the future and as a research community we must encourage such designs
   which leads to social bonds and improve quality.$  Randomization has been the
   practice and only few peer grading papers describe incentive based mechanisms /
   weighted score mechanisms than random ( whish this paper not talk about Tomas
   Stzubits paper in LScale 2016 and Tuned model for peer reviewing paper).$
   Although I see the importance of this paper ad I really want the CSCW community to
   encourage such designs, I am not convinced on the method of the research.$
   From what I understand – this study conducted as an extra or additional feedback
   session in the on site classroom. This means students interact during the class
   and when they present their products in the class they know who’s project is that.
   Specially in a class of 56 it is very likely that students can know each in their
   presented projects. My concern is this jeopardize anonymity. Because it is one
   factor that may affect to the feedback (Gamage et al 2017 L@S). $Besides online
   peer reviewing is well suit in context when students do not meet and take a course
   and review without meeting in a place onsite.$
   Next question is – since there are groups which contain 2-3 students, did all of
   them submit one project and at least one student is assigned through out one other
   project? Or is it teams together who provide the reviews? Say for example you have
   student 1 , 2 3 4 5 6, and team A ( Student 1,2) Team B ( Student 3, 4) Team C (
   Student 5, 6) Team A prototype has been reviewed by student 3 through out or is it
   a team.$
   Social bonding in the virtual community is very important for any educational
   technology which envision pedagogical styles in beyond 2020 and this paper is
   stepping forward the right direction. $However, I would not be convince for that
   fact that they did not do an online or at least the anonymity is under doubt.$ I
   suggest to re-design the study where at least the students take the class and
   design an assignment where they do not interact in the reviewing in the class.$
   Although its minor typo ( in the Discussions and futurework) [Grace, Helen] should
   be a numerical reference.$


</span>

<span class='table-text'>
This paper claims three key contributions to the CSCW community:$
   1. Empirical understanding of how two variables affect online peer feedback
   exchange in a product design course: peer assignment strategy (“mentor” vs.
   random) and showing design process documentation (“context” vs. no “context”),$
   2. Practical guidelines for instructors of design courses to determine when to use
   each feature,$
   3. Design implications for online peer feedback platforms.$

   The key evaluation criteria for such empirical contributions in HCI are
   rigor/precision in methods and importance of findings (Wobbrock, 2012. “Seven
   Research Contributions in HCI,”$

This paper holds a potentially important and novel empirical contribution to the
   CSCW community, supported by standard methods for peer feedback research and
   interesting quantitative and qualitative results.$ With some improvement on the
   paper’s communication, I believe it could be a strong contribution to this year’s
   program.$

The motivating research problem is timely, relevant, and practical to the CSCW
   community: How can instructors increase student engagement and feedback quality on
   online peer feedback exchange platforms to keep pace with the growing sizes of
   project-based design courses?$

   In addressing this problem, the paper demonstrates strong command over relevant
   literature in the research space around peer feedback exchange from the
   perspective of HCI and learning science communities.$ It proposes two interesting
   new features that could potentially improve online peer feedback exchange (peer
   assignment strategy and showing “context”), and tests them in a controlled
   experiment with an appropriate suite of methods that have been used in previous
   studies on peer feedback exchange (e.g., quantitative behavioral measures and
   self-reports, followed by qualitative interviews).$

   Through these methods, the paper surfaces many practically important results,
   including a significant interaction effect of Context and Stage on perceived
   feedback quality, greater receptivity to feedback amongst “mentors” vs. random-
   assigned students, tradeoffs between the two assignment strategies, and generally
   positive student perceptions of the peer feedback activity.$ The qualitative piece
   of the study is especially strong in that it reveals practically important
   findings that could not have been captured with the quantitative measures alone.$

   In terms of the key evaluation criteria for empirical contributions, this paper
   demonstrates  well-executed methods, which gives credibility to its interesting
   results.$

   My main concerns involve strengthening the communication of the paper: clarifying
   the motivation and clarifying the results.$
   I was a bit confused about the role of social bond theory in the paper’s
   motivation. $It is stated as the key inspiration behind the two proposed variables
   (assignment strategy and showing context), and it is suggested as a possible
   mediator between online peer feedback platform features and feedback quality under
   the Related Work section (“However, as the use of educational technology begins to
   move these interactions online, a consequence is that peers may feel less attached
   to each other, less committed to the course goals, and less involved in the
   activity. $This could explain why studies of online peer review have shown that the
   content often has limited scope and quality [33, 36, 39].”... “Peer mentorship may
   increase the social bond between designers and feedback providers (e.g. they will
   feel more committed to the design project for which they are giving feedback and
   move involved in the feedback activity), and lead to higher quality feedback.”)$
   This set-up suggested to me that one of the Research Questions would be on this
   mediation relationship, but it was never addressed in the paper. $The reported null
   and negative effects of mentorship on social bond, but statistically significant
   effects on other feedback attributes/responses in the Results section further
   confused me, as they seemed to directly contradict the suggested role of social
   bond from the beginning of the paper.$ Explicitly clarifying the proposed role of
   social bond and its relationship with the independent and dependent variables in
   the beginning of the paper (e.g., Related Work section) as well as at the end of
   the paper (e.g., Discussion section) might reduce this confusion.$

   In addition to the role of social bond in the study, I was also a bit confused
   about the motivation behind some of the dependent variables.$ Besides social bond
   and feedback quality, none of the other dependent variables were mentioned in the
   set-up of the paper (e.g., Introduction and Related Work sections), so it was
   unclear to me why they were collected for this study in the Method section. $For
   example, why are feedback length and response length important here?$ My implicit
   assumption is that they might be indicators of student investment (which
   constitutes social bond), but I also know that length is not an accurate indicator
   as it is a well-known strategy amongst students to write tons of sentences that
   are devoid of true substance just to fill space on a writing assignment. $Such
   uncertainty about the meaning of dependent constructs made it difficult for me to
   interpret the subsequent Results section. $Similarly, why is feedback sentiment
   important here? Does positive vs. negative sentiment have significant implications
   for student engagement or feedback quality?$ Providing explicit motivations for
   each dependent variable as they relate to the overall research problem of
   improving online peer feedback exchange when they are introduced in either the
   Related Work section or Method section would strengthen the communication of the
   paper and help readers form a better mental model of the intended narrative.$

   Due to the lack of motivation for each dependent measure presented in the
   beginning of the paper, the current Results section reads a bit like a laundry
   list rather than a clear narrative. $I got a bit lost while reading it, as it was
   unclear what the most important results are, how each of the results relate back
   to the overall research problem of improving online peer feedback exchange, and
   what the the overall takeaway is.$ The sentences of speculation after some of the
   findings helped me interpret them a little bit (e.g., under Feedback Length, “A
   possible explanation is that students allocate an attention budget for the
   feedback composition task, and effort invested in evaluating the design context is
   subtracted from writing the feedback.”), $although I found myself identifying
   alternative explanations as well (e.g., Another reason why feedback length was
   shorter for providers with Context than those with No Context might be because the
   designer’s intent was clearer and required less critique or clarification with
   Context- especially since the majority of feedback content was of this nature:
   judgement, recommendation, and investigation, interpretation.)$

   In addition to clarifying the narrative of results as they relate back to the
   overall research problem of improving online peer feedback exchange, I also
   recommend presenting graphical visualizations of the most important findings (e.g.
   interaction effect of Context and Stage on perceived quality). $This would make the
   results easier to interpret at a glance (the current tables and text are a bit
   difficult to weed through),$ and could be one way to help the reader identify which
   are the most important results (graphically visualized in bar graphs or line
   graphs) vs. which are less important (only reported in text).$

   Finally, three more minor concerns/clarifications:$
   - Under the “Actions taken (RQ1)” section: Are the percentages reported here on
   average per designer or for all designers overall?$
   - Under the “Qualitative Results (RQ3)” section, it states “We report results of
   the final survey (Table 6; n=55)”, but Table 6 only shows the text of questions in
   the final survey and not the Likert scale results for each question. $For
   comprehensiveness, I would like to see the numerical results from this survey.$
   - It would further strengthen the narrative of the paper if results are reported
   in the same order as the measures are introduced in the Method section. This
   parallel structure helps make it easier for readers to follow.$

   Given the strengths of the paper (e.g., timeliness, relevance, and practicality of
   the motivating research problem, appropriate suite of methods implemented,
   interesting set of findings reported), I believe the weaknesses are mostly a
   matter of written communication and clarification rather than significant
   overhauls of research execution. $As such, I believe it is “Probably acceptable
   (with minor modifications).” I wish the authors the best of luck going forward and
   encourage the continuation of their valuable work on online peer feedback exchange
   systems.$


</span>
</div>
</div>
</div>

</div>

<div id='page-2' style="display: none;">


<div class="container-fluid">
	<div class="main-section" style="margin-top: 50px">


	<div class="alert alert-info" role="alert" >
		<h4>Instruction</h4>
	 We collect six pieces of feedback from independent reviewers. The feedback set is categorized and transformed into a summary panel (on the right hand side). You can interact with the panel to explore the feedback set. 

	 <a type="button" class="btn btn-info" onclick='backAnnotate();'>Revise My Annotate</a>
	</div>
  
	<div class="row">    

		<div class="col-md-6"> 
			<table class='table table-nonfluid'>
			<tbody id='feedback-list'>
			</tbody>
			</table>
		</div>

<!--user input-->
<div class="modal fade" id="annotate" aria-hidden="true" role="dialog">
  	<div class="modal-dialog" role="document">
    <div class="modal-content">
    	<div class="modal-header">
    		<p id='selected-text'></p>
    	</div>
      	
      	<div class="modal-body">
      	<form>      	
	      	<div class="form-group">
	    		<label for="topic"><b>Create an Action Item</b></label>
	   	 		<input type="email" class="form-control" id="topic" aria-describedby="emailHelp" placeholder="e.g. Select an image with a sun">
	    		<small class="form-text text-muted">Use a few words to decribe what you will do with this feedback.</small>
	    		
	  		</div>


	  		<hr>
	  		<div class="form-group">
	    		<label for="topic"><b>Associate This Action Item with ...</label></b>
	   	 		<select>
	   	 			<option>Select an image without sun glare.</option>
	   	 			<option>Select an image with multiple people.</option>
	   	 		</select>
	  		</div>
      		<hr>
      		<div class="form-check form-check-inline">
						  <input class="form-check-input filter-input" type="checkbox"  value="no-value">
						  <label class="form-check-label" for="criticality"><b>Mark as no action needed for solving this item</b></label>
						</div>
      	</form>
      	</div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary">Save changes</button>
      </div>
    </div>
  </div>
</div>

<div class="col-md-6">

<div class="card">
	     <div class="card-header">
    Show Areas of Feedback
  </div>
  <div class="card-body">

  		<form>
				<div class="form-group row">
				    <legend class="col-sm-3 col-form-label"><b>Estimated Revision Effort</b></legend>
				    <div class="col-sm-9">
						<div class="form-check form-check-inline">
						  <input class="form-check-input filter-input" type="checkbox" name="effort" value="high">
						  <label class="form-check-label" for="effort">High</label>
						</div>
						<div class="form-check form-check-inline">
						  <input class="form-check-input filter-input" type="checkbox" name="effort" value="medium">
						  <label class="form-check-label" for="effort">Medium</label>
						</div>
						<div class="form-check form-check-inline">
						  <input class="form-check-input filter-input" type="checkbox" name="effort" value="low">
						  <label class="form-check-label" for="effort">Low</label>
						</div>
				    </div>
				 </div>

				<div class="form-group row">
				     <legend class="col-sm-3 col-form-label"><b>Criticality</b></legend>
				    <div class="col-sm-9">
						<div class="form-check form-check-inline">
						  <input class="form-check-input filter-input" type="checkbox" name="criticality" value="high">
						  <label class="form-check-label" for="criticality">High</label>
						</div>
						<div class="form-check form-check-inline">
						  <input class="form-check-input filter-input" type="checkbox" name="criticality" value="medium">
						  <label class="form-check-label" for="criticality">Medium</label>
						</div>
						<div class="form-check form-check-inline">
						  <input class="form-check-input filter-input" type="checkbox" name="criticality" value="low" >
						  <label class="form-check-label" for="criticality">Low</label>
						</div>
				    </div>
				 </div>

				 <div class="form-group row">
				     <legend class="col-sm-3 col-form-label"><b>Need Discussion</b></legend>
				    <div class="col-sm-9">
						<div class="form-check form-check-inline">
						  <input class="form-check-input filter-input" type="checkbox" name="discussion" value="yes">
						  <label class="form-check-label" for="discussion">Yes</label>
						</div>
						<div class="form-check form-check-inline">
						  <input class="form-check-input filter-input" type="checkbox" name="discussion" value="no">
						  <label class="form-check-label" for="discussion">No</label>
						</div>
				    </div>
				 </div>


				 <div class="form-group row">
				     <legend class="col-sm-3 col-form-label"><b>Agree</b></legend>
				    <div class="col-sm-9">
						<div class="form-check form-check-inline">
						  <input class="form-check-input filter-input" type="checkbox" name="agree" value="completely">
						  <label class="form-check-label" for="agree">Completely</label>
						</div>
						<div class="form-check form-check-inline">
						  <input class="form-check-input filter-input" type="checkbox" name="agree" value="partially">
						  <label class="form-check-label" for="agree">Partially</label>
						</div>
						<div class="form-check form-check-inline">
						  <input class="form-check-input filter-input" type="checkbox" name="agree" value="no">
						  <label class="form-check-label" for="agree">No</label>
						</div>
				    </div>
				 </div>

		</form>

  
  </div>
</div>
		


<!--Panel-->
<table class="table" style="font-size: 20px">
	<thead>
    <tr>
      <th scope="col">Topic</th>
      <th scope="col">Positive</th>
      <th scope="col">Negative</th>
      <th scope="col">Suggestion</th>
    </tr>
  </thead>

<tbody id='paneltest'>
	
</tbody>
</table>

</div>
</div>
</div><!--end of page 2-->



</div>









		
</div>
<script>
var all_idea_units = {}
var number_of_providers=0;

//var topicName=['image','layout'];
var sentimentName=['strength','weakness','suggestion'];
var topicArray={};
var topics=[];

class LabelClass {
  constructor(topic, sentiment, criticality,effort, discussion, agree, visited) {
    this.topic = topic;
    this.sentiment = sentiment;
    this.criticality = criticality;
    this.effort = effort;
    this.discussion = discussion	;
    this.agree = agree	;
    this.visited = visited;
  }
}

$(function(){

		
  //$('[data-toggle="tooltip"]').tooltip(); 
	$(".table-text", "#page-1").each(function (table_i) {
		
		var current_html_table = $($('div#page-1 template[name="feedback_table"]').html());
		var reviewer_i = table_i + 1;
		number_of_providers=reviewer_i;
		var text = ($(this).text()).split('$');
		current_html_table.attr('id',reviewer_i);
		$('a', current_html_table).attr('href', '#original'+reviewer_i );
		$('[name="original-feedback"]', current_html_table).html("<b>Original Feedback : </b><br>"+ $(this).text()+"<br>");
		$('[name="original-feedback"]', current_html_table).attr('id','original'+reviewer_i );
		var text_vis_table='';

		for (var i = 0; i < text.length; i++) {
			
			text_vis_table=text_vis_table+	"<span class='idea-unit' data-toggle='modal' data-target='#annotate' id='" + reviewer_i + "-" + i + "'>" + text[i] + "</span>";

			var current_feedback_row = $($('div#page-1 template[name="feedback-row-template"]').html());
			current_feedback_row.attr('id', reviewer_i + "-" + i );
			$('[name="ideaid"]', current_feedback_row).html(reviewer_i+ "-" + i);
			$('[name="content"]', current_feedback_row).html(text[i]);
			$('[name="add-btn"]', current_feedback_row).attr('id', reviewer_i + "-" + i);
			$('[name="topic"]', current_feedback_row).attr('id', reviewer_i + "-" + i);
			$('[name="new-topic"]', current_feedback_row).attr('id', "newfor"+reviewer_i + "-" + i);
			
			//var text_spanned="<tr id='" + reviewer_i + "-" + i + "'> <th scope='row'>"+reviewer_i+ "-" + i+"</th><td>"+text[i]+"</td><td><select name='topic'><option></option><option>image</option><option>layout</option><option>font</option><option>color</option><option>copy issue</option></td><td><select name='sentiment'><option></option><option>positive</option><option>negative</option><option>suggestion</option></select></td><td><select name='effort'><option></option><option>high</option><option>medium</option><option>low</option></select></td><td><select name='criticality'><option></option><option>high</option><option>medium</option><option>low</option></select></td><td><select name='discussion'><option></option><option>yes</option><option>no</option></td> <td><select name='agree'><option></option><option>completely</option><option>partially</option><option>no</option></td> </tr>";
			
			$('#ideaunits', current_html_table).append(current_feedback_row);

			var ideaunit = {
				id: reviewer_i + "-" + i,
				content: text[i],
				topic: null,
				sentiment: 0,
				criticality: 0,
				effort: 0,
				discussion: false,
				agree: 0,
				visited:false,
				action:null
			};
			all_idea_units[reviewer_i + "-" + i] = ideaunit;
		}

		$('#all_feedback_table').append(current_html_table);

		$("<li class='page-item'><a class='page-link' id='feedback-"+reviewer_i+"'>"+reviewer_i+"</a></li>").insertBefore('#next');

		$('#feedback-list', "div#page-2").append("<tr><td><strong>#"+reviewer_i+"</strong></td><td class='vis-content'>"+text_vis_table+"</td></tr>");
		
	})

		$(".page-item:eq(1)").addClass('active');
		$(".annotate-panel#1").show();

		$(".page-link").click(function(){
			$(".page-item").removeClass('active');
			$(this).closest(".page-item").addClass('active');
			var current_page= $(this).attr("id").split('-');
			$(".annotate-panel", "#page-1").hide();
			$(".annotate-panel#"+current_page[1], "#page-1").show();
		});

		$("select", "#page-1")
	  		.change(function () {

	    	var current_tag= $(this).attr("name");
	      	var current_idea= $(this).closest("tr").attr("id");
	      	//var current_value = $(this).find(":selected").text();
	      	all_idea_units[current_idea][current_tag] = $(this).find(":selected").text();
	      	console.log(JSON.stringify(all_idea_units[current_idea]));	     	
		 });
		
// Page 2


	$("div#page-2").on('click', ".filter-input", function(){

		renderInterpretation();

	});

	$("div#page-2").on('click','.tableelement', function() {
		
		var span_id = $(this).attr("id").split('-');
		var topic= span_id[0];
		var sentiment=span_id[1];
		var people_id=span_id[2];
		console.log(span_id);
		//todo
		for(var key in all_idea_units){
			//console.log(tmp);
			var tmp_id=key.split('-');
			if( (tmp_id[0] == people_id)&&(sentiment==all_idea_units[key]['sentiment'])&&(topic == all_idea_units[key]['topic']))
			{				
				console.log(key);
		//todo
				$("span.idea-unit#"+key, "#page-2").addClass("visited");
				all_idea_units[key].visited=true; 
				$(".tableelement#"+key+" > span", "#page-2").css("color","blue");
			}//all_idea_units[currentIdeaLists[i].id].visited=true; 
		}





	})

	$("div#page-2").on('mouseenter','.tableelement', function() {
		

		var span_id = $(this).attr("id").split('-');
		var topic= span_id[0];
		var sentiment=span_id[1];
		var people_id=span_id[2];
		console.log(span_id);
		//todo
		for(var key in all_idea_units){
			//console.log(tmp);
			var tmp_id=key.split('-');
			if( (tmp_id[0] == people_id)&&(sentiment==all_idea_units[key]['sentiment'])&&(topic == all_idea_units[key]['topic']))
			{				
				$("span.idea-unit#"+key, "#page-2").addClass("active-text");
				//all_idea_units[key].visited=true; 
				//$(".tableelement#"+key+" > span", "#page-2").css("color","blue");
			}//all_idea_units[currentIdeaLists[i].id].visited=true; 
		}

	});

	$("div#page-2").on('mouseleave','.tableelement', function() {
		
	    $("span.idea-unit", "#page-2").removeClass("active-text");
	    
	  
	});


	//$("div#page-1").on('click','.add-btn', addOption);

	$("div#page-1").on('focusout','[name="new-topic"]', addOption);	

	$.map( $(".feedback-row select[name='topic']:first option"), function (option){
		topics.push(option.value);
		console.log(topics.length);
		} 
	);

	
/**********use delegate
	$(".tableelement", "div#page-2").click(function(){
		//step 1: get the idea unit id
		//var span_id_origin=$(this).attr("id");
		console.log("haha");
		var span_id = $(this).attr("id").split('-');
		var topic= span_id[0];
		var sentiment=span_id[1];
		var people_id=span_id[2];
		//todo
		for(var key in all_idea_units){
			//console.log(tmp);
			var tmp_id=key.split('-');
			if(tmp_id[0] == people)
			{
				//console.log(currentIdeaLists[tmp].id);
				var currentid=currentIdeaLists[tmp].id;
			$(".idea-unit#"+key).addClass("visited");
			all_idea_units[key].visited=true; 
			$(".tableelement#"+key+" > span").css("color","blue");
			}//all_idea_units[currentIdeaLists[i].id].visited=true; 
		}
		var span_id = $(this).attr("id");
		$('#selected-text').html($(this).text());
		

	})

		$( ".tableelement","#page-2").hover(

  				 function() {
  				 	console.log("come in table element");
  				 		//var span_id_origin=$(this).attr("id");
						var span_id = $(this).attr("id").split('-');
						console.log(span_id);
						var topic= span_id[0];
						var sentiment=span_id[1];
						var people_id=span_id[2];
		//todo
				for(var key in all_idea_units){
						//console.log(tmp);
					var tmp_id=key.split('-');
					if(tmp_id[0] == people)
					{
						$(".idea-unit#"+key).removeClass("visited");
							$(".idea-unit#"+key).addClass("active");
						}


 				 }
 				}, 

 				 function() {

 				 		var span_id = $(this).attr("id").split('-');
						var topic_index= topicName.indexOf(span_id[0]);
						var sentiment_index=span_id[1];
						//todo
						var currentIdeaLists= topicArray[topic_index][sentiment_index];
	 					
				for(var tmp=0; tmp<currentIdeaLists.length ; tmp++)
				{
						//console.log(tmp);
					tmp_id=(currentIdeaLists[tmp].id).split('-');
					if(tmp_id[0] == span_id[2])
					{
						//console.log(currentIdeaLists[tmp].id);
						var currentid=currentIdeaLists[tmp].id;
							$(".idea-unit#"+currentid).removeClass("active");
							if(all_idea_units[currentid].visited == true)
 				 			{
 				 				$(".idea-unit#"+span_id).addClass("visited");
 				 			}
							
						}


 				 }

  				}
	);

************************/
	$("span.idea-unit", "page-2").hover(

		 	function() {
		 		
  				var span_id = $(this).attr("id");
  				var people_id=span_id.split('-');
  				console.log(span_id);
				for(var i=0; i<topicArray.length;i++)// lopping the topic
				{				
					for(var sentiment=0; sentiment < topicArray[i].length;sentiment++)
					{
						var currentArray=topicArray[i][sentiment];
						for(var idx_unit=0; idx_unit<currentArray.length;idx_unit++)// lopping the topic
						{
							
							if(span_id == currentArray[idx_unit].id){
								console.log("get it");
								$(".tableelement#"+topicName[i]+'-'+sentiment+'-'+people_id[0]+" > span").addClass("active-icon");	
				
							}
							
						}		
					}

				}
						
			},
			function() {
				$(".tableelement > span").removeClass("active-icon");
			}
	);








	

});

//var topics=[];

function addOption(){
   
	$("p[name='check-result']").text("").removeClass();
    var element=$(this);
    element.siblings("#check-result").text("").removeClass();
    var id=element.attr('id');
    //console.log("call addoption",id);
   	var tmptopic = $(this).val();

   	//console.log("new topic", tmptopic, topics.indexOf(tmptopic) );
	/*$.map( $(".feedback-row select[name='topic']:first option"), function (option){
		topics.push(option.value);
	} 
	);*/
   //var options= $(el).parent().children("select option");

  var msg='';
  var status='success';

   if( tmptopic!="")
   {

   		 if( topics.indexOf(tmptopic) == -1){

   		 	var currentid=element.parent().children("select").attr("id");
   			console.log("in if", currentid);

   				topics.push(tmptopic);
   				$(".feedback-row select[name='topic']").each(function(){
    	
					$(this).append( new Option( tmptopic, $('#new-topic').val(), false, false) );
    			//$(this).options[$(this).options.length] = new Option('New Element', '0', false, false);
    			});
   				//console.log(element.parent().children("select").attr("id"));
				element.parent().children("select").val(tmptopic);
				//element.parent().children("select").css('background-color','yellow');
				//$(el).parent().children("select option[value='"+tmptopic+"']").attr('selected','selected');
				all_idea_units[currentid]['topic'] =tmptopic;
	   		 	console.log(JSON.stringify(all_idea_units[currentid]));
	    		//element.siblings("#check-result").text("Successfully added"+).addClass('success');
	    		msg="'"+tmptopic+"' is added!";
	    		status='success';
   				
   		 }else
   		 {
   		 		msg="'"+tmptopic+"' alrady exists!";
   				status='fail';
   		 } 

   		 element.siblings("[name='check-result']").text(msg).addClass(status);
		element.val("");
   		
   }
  
    
}




function finishAnnoate(){

	createTopicArray();
	renderElement();
	renderFactual();

	$('#page-2').show();
	$('#page-1').hide();
}


function backAnnotate(){

	$('#page-1').show();
	$('#page-2').hide();
}
//For page 2
    
function createTopicArray()
{
	topicArray={};
	//var number_of_idea= Object.keys(all_idea_units).length;
	for (var key in all_idea_units) {
    // check if the property/key is defined in the object itself, not in parent
    //console.log(all_idea_units[key]['topic']);
    var current_topic=all_idea_units[key]['topic'];
    var current_sentiment=all_idea_units[key]['sentiment'];
    //console.log(current_topic,current_sentiment );	
    	if(current_topic!=null && current_sentiment!=0){
	    	if(!(current_topic in topicArray))
	    	{
	    		var currentArray={};
	    		sentimentName.forEach(function(element) {
  					currentArray[element] =new Array();
				});

	    		topicArray[current_topic] = currentArray;
	    	}
	    	topicArray[current_topic][current_sentiment].push(all_idea_units[key]);
	    	//console.log(JSON.stringify(topicArray));
		}

    }
}

function generateSummaryTable()
{
	console.log("refresh summary table");

}



	
function print(par)
{
	console.log(par);
}	


function renderElement(){
	
	$("#paneltest").empty();
	for (var topicKey in topicArray) {
		
		var currentTopic=topicArray[topicKey];

		var inser_html="";
		
		inser_html=inser_html+"<tr id='"+topicKey+"'><th scope='row'>"+topicKey+"</th>";
		var sentimentNum=0;
		for (var sentimentKey in currentTopic) {

			
			inser_html+="<td id='sentiment"+sentimentKey+"'>";
			var people_id=1;
			for(var index=0; index<number_of_providers;index++)// lopping the topic
			{
				inser_html=inser_html+"<a class='tableelement' data-toggle='tooltip' id='"+topicKey+'-'+sentimentKey+'-'+people_id+"'><span class='fa fa-user' style='color:#c2d6d6; font-size:24px;margin-right:3px'></span></a>";

				
				people_id++;
			}
			inser_html+="</td>";
			sentimentNum++;
		}
		inser_html+="</tr>";
		
		$("#paneltest").append(inser_html);
	}
}

function renderFactual(){

	for (var key in all_idea_units) {
		var people_id=key.split('-');
		//console.log("#"+all_idea_units[key]['topic']+'-'+all_idea_units[key]['sentiment']+'-'+people_id[0]);
		$("#"+all_idea_units[key]['topic']+'-'+all_idea_units[key]['sentiment']+'-'+people_id[0]+" > span").css('color','black');	
	}

}
	


function renderElementbk(){
	
	for(var i=0; i<topicArray.length;i++)// looping the topic
	{		
		var inser_html="";
		 inser_html=inser_html+"<tr id='"+topicName[i]+"'><th scope='row'>"+topicName[i]+"</th>";
		//$("#paneltest").append("<tr><th scope='row'>"+topicName[i]+"</th>");
			//console.log(inser_html);
		for(var sentiment=0; sentiment < topicArray[i].length;sentiment++)
		{
			var currentArray=topicArray[i][sentiment];
			inser_html+="<td id='sentiment"+sentiment+"'>";
			var people_id=1;
			for(var index=0; index<number_of_providers;index++)// lopping the topic
			{
				inser_html=inser_html+"<a class='tableelement' data-toggle='tooltip' id='"+topicName[i]+'-'+sentiment+'-'+people_id+"'><span class='fa fa-user' style='color:#c2d6d6; font-size:24px;margin-right:3px'></span></a>";

				
				people_id++;
			}
			inser_html+="</td>";
			//$("#paneltest").append(renderCell);
		}
		inser_html+="</tr>";
		
		$("#paneltest").append(inser_html);
	}
}

function renderFactualbk(){


		for(var i=0; i<topicArray.length;i++)// lopping the topic
		{		

		
		for(var sentiment=0; sentiment < topicArray[i].length;sentiment++)
		{
			var currentArray=topicArray[i][sentiment];

			for(var idx_unit=0; idx_unit<currentArray.length;idx_unit++)// lopping the topic
			{
				var people_id=(currentArray[idx_unit].id).split('-');
				//print(people_id[0]);
				$("#"+topicName[i]+'-'+sentiment+'-'+people_id[0]+" > span").css('color','black');	
				
			}

			//$("tr#"+topicName[i]+' > td#sentiment'+sentiment+" > a#"+people_id[0]).css('color','yellow');		
			//console.log("tr#"+topicArray[i]+' > td#sentiment'+sentiment);	
			//$("#paneltest").append(renderCell);
		}

	}

}
	

function renderInterpretation(){

	var numToString=['low','low','low','medium','high','high'];
	
	var checked_effort = [];
	var checked_criticality = [];
	var need_discussion = [];
	var agreement = [];


	$('input[name=effort]:checked').each(function() {checked_effort.push($(this).attr('value'));});
	$('input[name=criticality]:checked').each(function() {checked_criticality.push($(this).attr('value'));});
	$('input[name=discussion]:checked').each(function() {need_discussion.push($(this).attr('value'));});
	$('input[name=agree]:checked').each(function() {agreement.push($(this).attr('value'));});
//if nothing is selected 
if( checked_effort.length > 0 || checked_criticality.length>0 || need_discussion.length>0 || agreement.length>0 )
{


	for (var key in all_idea_units) {
		var people_id=key.split('-')[0];

		var current_topic = all_idea_units[key]['topic'];
		var current_sentiment = all_idea_units[key]['sentiment'];

		var current_effort = all_idea_units[key]['effort'];
		var current_criticality = all_idea_units[key]['criticality'];

		var current_discussion = all_idea_units[key]['discussion'];
		var current_agreement = all_idea_units[key]['agree'];


		if( (checked_effort.length>0 == checked_effort.indexOf(current_effort)>-1) 
			&& (checked_criticality.length>0 == checked_criticality.indexOf(current_criticality)>-1 )
			&& (need_discussion.length>0 == need_discussion.indexOf(current_discussion)>-1 )
			&& (agreement.length>0 == agreement.indexOf(current_agreement)>-1))
		{
			$(".tableelement#"+current_topic+'-'+current_sentiment+'-'+people_id+" > span").addClass('highlight');	
		}
		else
		{
			$(".tableelement#"+current_topic+'-'+current_sentiment+'-'+people_id+" > span").removeClass('highlight');	
		}		
	}
	
  /*	for( i = 0; i < topicArray.length;i++)// looping the topic
	{				
		for( sentiment=0; sentiment < topicArray[i].length;sentiment++)//sentiment
		{
			 currentArray=topicArray[i][sentiment];

			for(idx_unit=0; idx_unit<currentArray.length;idx_unit++)//idea units
			{
				var current_effort = numToString[currentArray[idx_unit].effort];
				var current_criticality = numToString[currentArray[idx_unit].urgency];

				var current_discussion = currentArray[idx_unit].discussion;
				var current_agreement = currentArray[idx_unit].agree;

				var content = currentArray[idx_unit].content;
				var tmp=currentArray[idx_unit];
				//console.log( current_effort, current_criticality, current_discussion,current_agreement);

				//console.log(checked_effort.indexOf(current_effort),checked_criticality.indexOf(current_criticality),need_discussion.indexOf(current_discussion),agreement.indexOf(current_agreement));
				//console.log(current_effort, checked_effort.indexOf(current_effort));
				var people_id=(currentArray[idx_unit].id).split('-');

				if( (checked_effort.length>0 == checked_effort.indexOf(current_effort)>-1) 
					&& (checked_criticality.length>0 == checked_criticality.indexOf(current_criticality)>-1 )
					&& (need_discussion.length>0 == need_discussion.indexOf(current_discussion)>-1 )
					&& (agreement.length>0 == agreement.indexOf(current_agreement)>-1))
				{
					$("#"+topicName[i]+'-'+sentiment+'-'+people_id[0]+" > span").addClass('highlight');	
				}
				else
				{
					$("#"+topicName[i]+'-'+sentiment+'-'+people_id[0]+" > span").removeClass('highlight');	
				}	
							
			}
			
		}

	}
	*/
}else{
	$('.tableelement span').removeClass('highlight');
}

}


</script>